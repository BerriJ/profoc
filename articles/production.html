<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="profoc">
<title>Production â€¢ profoc</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Production">
<meta property="og:description" content="profoc">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">profoc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/profoc.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/production.html">Production</a>
    <a class="dropdown-item" href="../articles/class.html">Using the C++ Interface</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/BerriJ/profoc/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Production</h1>
                        <h4 data-toc-skip class="author">Jonathan
Berrisch</h4>
            
            <h4 data-toc-skip class="date">2024-01-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/BerriJ/profoc/blob/HEAD/vignettes/production.Rmd" class="external-link"><code>vignettes/production.Rmd</code></a></small>
      <div class="d-none name"><code>production.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="using-online-in-production">Using <code>online</code> in Production<a class="anchor" aria-label="anchor" href="#using-online-in-production"></a>
</h2>
<p>This vignette explains the use of <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> and
<code><a href="https://rdrr.io/r/stats/update.html" class="external-link">update()</a></code>. These are the two most important functions when
using <code>profoc</code> in production. The <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code>
method is used to combine new expert forecasts using the most recent
combination weights. This is useful if we combine new expert forecasts
with the most recent combination weights, but new observations have yet
to be realized. At a later point, <code><a href="https://rdrr.io/r/stats/update.html" class="external-link">update()</a></code> can be used to
update the combination weights by evaluating the realized observations.
We assume that you followed the <code><a href="../articles/profoc.html">vignette("profoc")</a></code> already.
We will reuse the data and the model from there.</p>
<div class="section level3">
<h3 id="combining-new-expert-predictions">Combining new expert predictions<a class="anchor" aria-label="anchor" href="#combining-new-expert-predictions"></a>
</h3>
<p>First, we create new expert predictions:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_experts</span> <span class="op">&lt;-</span> <span class="va">experts</span><span class="op">[</span><span class="cn">T</span>, , , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span></code></pre></div>
<p>The default behavior of <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> updates the
<code>combination</code> object. So, it can later be used to update the
combination weights as realized values emerge. That is,
<code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> expands <code>combination$predictions</code> and
returns the updated <code>combination</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">combination</span><span class="op">$</span><span class="va">predictions</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 32  1 99</span></span>
<span></span>
<span><span class="co"># Predict will expand combination$predictions</span></span>
<span><span class="va">combination</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">combination</span>,</span>
<span>  new_experts <span class="op">=</span> <span class="va">new_experts</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">combination</span><span class="op">$</span><span class="va">predictions</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 33  1 99</span></span></code></pre></div>
<p>If you are only interested in the predictions, you can set
<code>update_model = FALSE</code>. In this case, <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code>
solely returns the predictions:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">combination</span>,</span>
<span>  new_experts <span class="op">=</span> <span class="va">new_experts</span>,</span>
<span>  update_model <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">predictions</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  1  1 99</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="updating-the-model-weights">Updating the model weights<a class="anchor" aria-label="anchor" href="#updating-the-model-weights"></a>
</h3>
<p>As new realizations emerge, we can update the combination weights.
This is done by <code><a href="https://rdrr.io/r/stats/update.html" class="external-link">update()</a></code>. That is, <code><a href="https://rdrr.io/r/stats/update.html" class="external-link">update()</a></code>
expands <code>combination$weights</code> and returns the updated
<code>combination</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># New observation</span></span>
<span><span class="va">new_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">combination</span><span class="op">$</span><span class="va">weights</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 33  1 99  2</span></span>
<span></span>
<span><span class="co"># Model Update</span></span>
<span><span class="va">combination</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">combination</span>,</span>
<span>    new_y <span class="op">=</span> <span class="va">new_y</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">combination</span><span class="op">$</span><span class="va">weights</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 34  1 99  2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="summary-on-predict-and-update">Summary on <code>predict()</code> and <code>update()</code><a class="anchor" aria-label="anchor" href="#summary-on-predict-and-update"></a>
</h3>
<p>As seen above, <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> and <code><a href="https://rdrr.io/r/stats/update.html" class="external-link">update()</a></code> are
closely related and usually called sequentially. In an only setting, we
want to calculate the forecast (the combination) as soon as new expert
predictions emerge. For that, we can use <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code>. Later,
as new observations are realized, we can <code><a href="https://rdrr.io/r/stats/update.html" class="external-link">update()</a></code> the
combination weights.</p>
<p>We designed to also work in non-standard scenarios. So if, for
example, experts provide multi-step-ahead predictions, we can use
<code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> to combine all of them using the most recent
combination weights. Afterward, one or multiple <code><a href="https://rdrr.io/r/stats/update.html" class="external-link">update()</a></code>
calls can be used to update the combination weights as new observations
are realized. If we want to <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> and
<code><a href="https://rdrr.io/r/stats/update.html" class="external-link">update()</a></code> simultaneously, we can do this. We can pass the
new expert predictions and observations to <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code>. This
will update the combination weights and predictions with only one call
to <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code>.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jonathan Berrisch, Florian Ziel.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
